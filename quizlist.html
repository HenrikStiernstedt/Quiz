<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Quiz Time</title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <!-- Bootstrap -->
    <!--<link href="css/bootstrap.min.css" rel="stylesheet">-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <script
      src="https://code.jquery.com/jquery-3.5.1.min.js"
      integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
      crossorigin="anonymous">
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>


    <!--<script src="js/bootstrap.min.js"></script>-->

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.16.0/dist/bootstrap-table.min.css">
    <!-- Vue -->
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <!-- production version, optimized for size and speed -->
    <!--<script src="https://cdn.jsdelivr.net/npm/vue"></script>-->


    <!-- socket.io -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.js"></script>

    <!-- My own stuff -->
    <link href="css/Quiz.css" rel="stylesheet">
    <script src="js/Quiz.js"></script>


  </head>
  <body>

  <div id="app">
    <div class="container-fluid" style="height: 100%">
      <div class="row clearfix hs-height">
        <div class="col-sm-12">
          <div class="progress">
            <div v-if="status.winningTeamName" class="progress-bar progress-bar-striped bg-warning" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width:100%" ></div>
            <div v-else-if="status.isBuzzActive" class="progress-bar progress-bar-striped progress-bar-animated bg-info" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width:100%"></div>
            <div v-else  class="progress-bar progress-bar-striped bg-info" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width:100%"></div>
          </div>
        </div>


<!--
          <div class="alert alert-success alert-dismissable" >
             <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
            <h4>
              Alert!
            </h4> <strong>Warning!</strong> Best check yo self, you're not looking too good.
            <a href="#" class="alert-link">alert link</a>
          </div>
-->


          <!--<button type="button" class="btn btn-block btn-lg btn-success active">Default</button>-->





              <!-- Kontroller för spelare -->
            <div class="questionInfo col-sm-6">

              <!-- Question area -->
<!--
              <transition name="slide-fade" >
                <div class="alert alert-primary" role="alert" :key="status.question.questionNumber">
                  Fråga nummer {{status.question.questionNumber}}:
                  <span v-if="status.question.questionType == 'RED_THREAD'">Röda tråden<br /></span>
                  <span v-if="status.question.questionType == 'MAJOR_VICTORY'">Majoreteten bestämmer<br /></span>
                  <span v-if="status.question.questionType == 'BUZZ_RUSH'">Handen på buzzern<br /></span>
                  <strong><span style="white-space: pre-line;">{{ status.question.questionText }}</span></strong>
                  <span v-if="status.question.questionScore != '0'"><br/>Värd
                    <transition name="bounce" mode="out-in">
                      <span :key="status.question.questionScore" class="badge badge-pill badge-secondary">{{status.question.questionScore}}</span>
                    </transition>
                   poäng
                 </span>
                </div>
              </transition>
-->
          <transition name="slide">
              <div class="card slideContainer"  v-bind:key="status.question.questionNumber">

                <span v-if="status.question.questionType == 'MAJOR_VICTORY'">
                  <img class="card-img-top" src="images/majorityrules3.png" alt="Majoriteten bestämmer">
                  <div class="card-body">
                    <div class="QuestionScoreOverlay" :key="status.question.questionScore"> {{status.question.questionScore}}</div>
                    <h5 class="card-title">Fråga nummer {{status.question.questionNumber}}: Majoriteten bestämmer</h5>
                    <p class="card-text">
                      <strong><span style="white-space: pre-line;">{{ status.question.questionText }}</span></strong>
                      <span v-if="status.question.questionScore != '0'"><br/>Värd
                        <transition name="bounce" mode="out-in">
                          <span :key="status.question.questionScore" class="badge badge-pill badge-secondary">{{status.question.questionScore}}</span>
                        </transition>
                       poäng
                      </span>
                    </p>

                  </div>
                </span>

                <span v-if="status.question.questionType == 'RED_THREAD'">
                  <img class="card-img-top" src="images/Pasparet2.png" alt="Röda tråden">
                  <div class="card-body">
                    <div class="QuestionScoreOverlay" :key="status.question.questionScore"> {{status.question.questionScore}}</div>
                    <h5 class="card-title">Fråga nummer {{status.question.questionNumber}}: Röda tråden</h5>
                    <p class="card-text">
                      <strong><span style="white-space: pre-line;">{{ status.question.questionText }}</span></strong>
                      <span v-if="status.question.questionScore != '0'"><br/>Värd
                        <transition name="bounce" mode="out-in">
                          <span :key="status.question.questionScore" class="badge badge-pill badge-secondary">{{status.question.questionScore}}</span>
                        </transition>
                       poäng
                     </span>
                    </p>

                  </div>
                </span>

                <span v-if="status.question.questionType == 'BUZZ_RUSH'">
                  <img class="card-img-top" src="images/buzzers3.png" alt="Buzzers">
                  <div class="card-body">
                    <div class="QuestionScoreOverlay" :key="status.question.questionScore"> {{status.question.questionScore}}</div>
                    <h5 class="card-title">Fråga nummer {{status.question.questionNumber}}: Handen på buzzern!</h5>
                    <p class="card-text">
                      <strong><span style="white-space: pre-line;">{{ status.question.questionText }}</span></strong>
                      <span v-if="status.question.questionScore != '0'"><br/>Värd
                        <transition name="bounce" mode="out-in">
                          <span :key="status.question.questionScore" class="badge badge-pill badge-secondary">{{status.question.questionScore}}</span>
                        </transition>
                       poäng
                     </span>
                    </p>

                  </div>
                </span>

              </div>


            </transition>
          </div>
              <!-- Answer area -->
              <div id="player" class="col-sm-6">
                <transition name="fade" mode="out-in">
                  <div class="card answerArea"  v-bind:key="status.question.questionType"> <!-- Only update on new question type. -->
                    <div class="card-body">
                      <span v-if="status.question.questionType == 'BUZZ_RUSH'">
                        <div v-if="status.winningTeam == player.id" v-on:click="buzz()" class="alert alert-success" role="alert">Du har buzzat!</div>
                        <div v-else-if="status.winningTeam" v-on:click="buzz()" class="alert alert-warning" role="alert">{{status.winningTeamName}} har buzzat.</div>
                        <div v-else-if="status.isBuzzActive" v-on:click="buzz()" type="button" class="btn btn-primary btn-lg btn-block">Buzz!</div>
                      </span>
                      <span v-else-if="status.isBuzzActive">
                        <div class="input-group input-group-lg mb-3">
                          <input v-model="player.pendingAnswer" @keyup.enter="buzz()" type="text" class="form-control" placeholder="Svar" aria-label="Lagnamn" aria-describedby="basic-addon2">
                          <div class="input-group-append">
                            <button class="btn btn-outline-secondary" v-on:click="buzz()" type="button">Svara</button>
                          </div>
                        </div>
                        <div>
                          <span v-if="player.submittedAnswer">Du har svarat: {{player.submittedAnswer}}</span>
                        </div>
                      </span>
                    </div>
                  </div>
                </transition>
              </div>
              <!-- End of Answer area -->


            <!-- Kontroller för score board -->
            <div class="playerTable col-sm-6">
              <div class="card">
                <div class="card-body" style="padding:0px;">
                  <table class="MaxWidth">
                    <thead>
                      <tr>
                        <th style="width:25px;">#</th>
                        <th style="width:200px;">Namn</th>
                        <th style="width:100px;">Status</th>
                        <th>Svar</th>
                        <th style="width:50px;">Poäng</th>
                        <th v-if="player.isQuizMaster">Knappar</th>
                      </tr>
                    </thead>
                  <tbody name="flip-list" is="transition-group">

                      <tr v-for="p in players" v-bind:key="p.team" v-bind:id="p.team" v-bind:questionScore="p.questionScore">
                        <td>
                          {{ p.team }}
                        </td>
                        <td v-bind:class="[player.id == p.team ?  'you' : '']" class="NameCell">{{ p.teamName }}
                          <transition name="bounce" mode="out-in">
                            <span :key="p.NumberOfWins" title="Antal vinster i matchen" v-if="p.NumberOfWins > 0" class="badge badge-pill badge-warning">{{p.NumberOfWins}}</span>
                          </transition>
                        </td>
                        <td>
                          <i v-if="player.id == p.team" class="fas fa-user" data-toggle="tooltip" title="Detta är du"></i>
                          <i v-else-if="p.active" class="far fa-user"></i>
                          <i title="Disconnected" v-else class="fas fa-skull-crossbones"></i>
                          <span v-if="p.buzzOrder">Buzz: {{ p.buzzOrder }}</span>
                          <i v-if="status.winningTeam == p.team" class="far fa-hand-paper shaking"></i>
                          <i v-if="p.isCorrect" class="far fa-star"></i>
                        </td>
                        <td>


                          <transition name="bounce">
                            <span v-if="p.questionScore > 0 && p.isCorrect" class="badge badge-pill badge-success questionScore">{{p.questionScore}}</span>
                            <span v-else-if="p.questionScore > 0" class="badge badge-pill badge-secondary questionScore">{{p.questionScore}}</span>
                          </transition>
                          <span v-if="p.answer">{{ p.answer }}</span>


                        </td>
                        <td> {{p.score}}</td>
                        <td v-if="player.isQuizMaster">

                          <a v-on:Click="givePoints((p.questionScore ? p.questionScore : status.question.questionScore), p.id, true)"><i v-if="p.isCorrect" class="far fa-star"></i><i v-else class="fas fa-star"></i></a>
                          <a onClick="givePoints(1, $(this).parent().parent().attr('id'), false);"><i class="fas fa-caret-up"></i></a>
                          <a onClick="givePoints(-1, $(this).parent().parent().attr('id'), false);"><i class="fas fa-caret-down"></i></a>
                        </td>
                    </tr>

                  </tbody>
                  </table>
                </div>
              </div>
            </div>






        <div class="col-sm-6 hs-height">

          <!-- Kontroller för QuizMaster -->
          <div v-if="player.isQuizMaster" class="quizMasterInfo col-sm-12">

            Du är QuizMaster
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <span class="input-group-text" id="asdf">Frågenummer</span>
              </div>
              <input v-model="quizMaster.pendingQuestion.questionNumber" type="text" class="form-control" aria-label="Default" aria-describedby="asdf">
            </div>
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <span class="input-group-text" id="inputGroup-sizing-default">Frågetyp</span>
              </div>
              <select class="form-control" type="select" v-model="quizMaster.pendingQuestion.questionType" >
                <option value="RED_THREAD">Röda tråden</option>
                <option value="MAJOR_VICTORY">Majoriteten bestämmer</option>
                <option value="BUZZ_RUSH">Handen på Buzzern</option>
              </select>
            </div>
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <span class="input-group-text" id="inputGroup-sizing-default">Fråga</span>
              </div>
              <textarea v-model="quizMaster.pendingQuestion.questionText" class="form-control" id="exampleFormControlTextarea1" rows="3"></textarea>
              <!--<input v-model="quizMaster.pendingQuestion.questionText" type="text" class="form-control" aria-label="Default" aria-describedby="inputGroup-sizing-default">-->
            </div>
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <span class="input-group-text" id="asdf">Poäng</span>
              </div>
              <input v-model="quizMaster.pendingQuestion.questionScore" type="text" class="form-control" aria-label="Default" aria-describedby="asdf">
            </div>
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <span class="input-group-text" id="asdf">Svar</span>
              </div>
              <input v-model="quizMaster.pendingQuestion.correctAnswer" type="text" class="form-control" aria-label="Default" aria-describedby="asdf">
            </div>
            <div class="btn-group" role="group" aria-label="Question-buttons">
              <button type="button" class="btn btn-primary mb-2" v-on:click="updateQuestion()">Uppdatera fråga</button>
              <button type="button" class="btn btn-primary mb-2" v-on:click="completeQuestion()">Avsluta fråga</button>
            </div>
            <div class="btn-group" role="group" aria-label="New-Question">
              <button type="button" class="btn btn-primary mb-2" v-on:click="newQuestion()">Ny fråga</button>
            </div>
            <div class="btn-group-prepend" role="group" aria-label="Game-buttons">
              <button type="button" class="btn btn-primary mb-2" v-on:click="newGame()">Ny omgång</button>
              <button type="button" class="btn btn-primary mb-2" v-on:click="purge()">Rensa inaktiva</button>
            </div>


          </div>
          <div v-else class="card">
            <div class="card-body">
              <div class="input-group input-group-sm mb-3">
                <input v-model="player.teamName" @keyup.enter="updateName()"  type="text" class="form-control" placeholder="Lagnamn" maxlength="40" aria-label="Lagnamn" aria-describedby="basic-addon2" autocomplete="off">
                <div class="input-group-append">
                  <button class="btn btn-outline-secondary" v-on:click="updateName()" type="button">Byt namn</button>
                </div>
              </div>
              <div class="input-group input-group-sm mb-3">
                <input v-model="player.quizMasterPassword" type="password" class="form-control" placeholder="" aria-label="QM" aria-describedby="basic-addon2" autocomplete="off">
                <div class="input-group-append">
                  <button class="btn btn-outline-secondary" type="button" id="MakeMeQuizMaster">QM pwd</button>
                </div>
              </div>
            </div>
          </div>
        </div>


      </div>
      <!-- Kontroller för chat -->
      <!--
      <div class="row clearfix hs-height">

        <div class="col-sm-12">

          <form role="form">
            <div class="form-group form-inline">
               <input type="text" placeholder="Say" class="form-control" id="m" />
             <button type="submit" class="btn btn-default">Submit</button>
           </div>
          </form>

          <div class="list-group hs-scroll" id="ChatBox">
             <a href="#" id="ChatHeader" class="list-group-item active">Chat</a>
          </div>

          <ul id="messages"></ul>

      </div>
      </div>
    -->
    </div>


    </div>
    <script src="https://unpkg.com/bootstrap-table@1.16.0/dist/bootstrap-table.min.js"></script>
    <script src="js/Quizlist.js"></script>

    <script>
      initQuizlist();

      $(function () {
        $('[data-toggle="tooltip"]').tooltip()
      })
    </script>


  </body>
</html>
